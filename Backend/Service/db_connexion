var request = require("request");
var neo4j = require('node-neo4j');


var URL_API_BASE = "http://178.62.87.171:7474/db/data/cypher";
var METHOD = {method: "POST"};
// Headers d'authenfication pour le serveur de DB neo4j
var AUTH =  { headers:
{
    'Authorization': 'Basic bmVvNGo6bWFmcmFqMjAxNQ==',
    'Content-Type': 'application/json'
}
};


 exports.callbackConnexion=function(error, response){

    if (!error && response.statusCode == 200) {
        //var info = JSON.parse(response.body);
        //console.log(response.body);

    }
    if(error){
        console.log(error);
    }

};


exports.prepareQuery=function(query) {

    var options = {
        url: URL_API_BASE,
        method: METHOD.method,
        headers: AUTH.headers,
        form:{query:query}
    };


    runCypherQuery(options);


};

function runCypherQuery(options) {
    request(options)
    .on('response', function(response) {
        var test = JSON.parse(response.body);
        console.log('HERE');
        console.log(test.data[0][0]);
    });
    }



